{% extends "clientBasic.html" %}
{% load staticfiles %}

{% block title %}创建用户端{% endblock %}

{% block nav_client %}active{% endblock %}

{% block sub_content %}
<div class="container row justify-content-sm-center">
  <div class="col-lg-8 col-md-10">
    <form id="clientCreate" method="POST" onsubmit="login();return false;">
      <fieldset>
        {% csrf_token %}
        <div class="form-group row">
              <label class="col-lg-3 col-md-4 control-label">对外可用</label>
              <div class="col-lg-9 col-md-8">
                <select name="available" class="form-control">
                  <option value="true" selected="selected">可用</option>
                  <option value="false">不可用</option>
                </select>
              </div>
            </div>
            <div class="form-group row">
              <label class="col-lg-3 col-md-4 control-label">名称</label>
              <div class="col-lg-9 col-md-8">
                <input maxlength="128" name="name" class="form-control" type="text">
              </div>
            </div>
            <div class="form-group row">
              <label class="col-lg-3 col-md-4 control-label">简介</label>
              <div class="col-lg-9 col-md-8">
                <textarea name="introduction" class="form-control"></textarea>
              </div>
            </div>
            <div class="form-group row">
              <label class="col-lg-3 col-md-4 control-label">开放所有题库</label>
              <div class="col-lg-9 col-md-8">
                <select name="allow_all" class="form-control">
                  <option value="true">开放所有题库</option>
                  <option value="false" selected="selected">不开放所有题库</option>
                </select>
              </div>
            </div>
            <div class="form-group row">
              <label class="col-lg-3 col-md-4 control-label">绑定账号</label>
              <div class="col-lg-9 col-md-8">
                <input maxlength="128" name="user" class="form-control" type="text">
              </div>
            </div>
            <br/>
            <div class="input-group-btn">
              <button class="btn btn-primary" title="保存信息">保 存</button>
            </div>
      </fieldset>
    </form>
  </div>
</div>
{% endblock %}

{% block script %}
<script>
function login() {
  var form = $("#clientCreate")
  var data = getFormData(form)

  $.ajax({
    type: "POST",
    async: false,
    url: "{% url 'admin-clients-list' %}",
    data: data,
    dataType: 'json',
    success: function(ret) {
      url = "{% url 'client_clients' %}" + ret.id
      location.href = url
    },
    error: function(a, b, c) {
      test_output(a)
    }
  })

  return false
}
</script>
{% endblock %}