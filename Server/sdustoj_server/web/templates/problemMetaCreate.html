{% extends "problemBasic.html" %}
{% load staticfiles %}

{% block title %}创建题元{% endblock %}

{% block nav_meta_problem %}active{% endblock %}

{% block sub_content %}
<div class="container row justify-content-sm-center">
  <div class="col-lg-8 col-md-10">
    <form id="metaCreateForm" method="POST" onsubmit="login();return false;">
      <fieldset>
        {% csrf_token %}
        <div class="form-group row">
          <label class="col-lg-3 col-md-4 control-label">对外可用</label>
          <div class="col-lg-9 col-md-8">
            <input name="available" class="form-control" type="checkbox">
          </div>
        </div>
        <div class="form-group row">
          <label class="col-lg-3 col-md-4 control-label">标题</label>
          <div class="col-lg-9 col-md-8">
            <input maxlength="128" name="title" class="form-control" type="text">
          </div>
        </div>
        <div class="form-group row">
          <label class="col-lg-3 col-md-4 control-label">简介</label>
          <div class="col-lg-9 col-md-8">
            <textarea maxlength="512" name="introduction" class="form-control"></textarea>
          </div>
        </div>
        <div class="form-group row">
          <label class="col-lg-3 col-md-4 control-label">来源</label>
          <div class="col-lg-9 col-md-8">
            <input maxlength="256" name="source" class="form-control" type="text">
          </div>
        </div>
        <div class="form-group row">
          <label class="col-lg-3 col-md-4 control-label">作者</label>
          <div class="col-lg-9 col-md-8">
            <input maxlength="64" name="author" class="form-control" type="text">
          </div>
        </div>
        <br/>
        <div class="input-group-btn">
          <button type="submit" class="btn btn-primary" title="保存题元信息">保 存</button>
        </div>
      </fieldset>
    </form>
  </div>
</div>
{% endblock %}

{% block script %}
<script>
function login() {
  var form = $("#metaCreateForm")
  var data = getFormData(form)

  $.ajax({
    type: "POST",
    async: false,
    url: "{% url 'admin-meta-problems-list' %}",
    data: data,
    dataType: 'json',
    success: function(ret) {
      url = "{% url 'problem_meta' %}" + ret.id
      location.href = url
    },
    error: function(a, b, c) {
      test_output(a)
    }
  })

  return false
}
</script>
{% endblock %}